import React from 'react';
import * as XLSX from 'xlsx';
import Button from 'react-bootstrap/Button';
import ExcelJS from 'exceljs';

const ExcelDownloadButton = ({ data }) => {
  const exportToExcel = async () => {
    const workbook = new ExcelJS.Workbook();
    const worksheet = workbook.addWorksheet('StudentData');

    // Add the logo image to the worksheet
    const logoImage = new Image(); // Create an image element
    logoImage.src = 'data:image/jpeg;base64,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'; // Replace with your logo image URL
    logoImage.crossOrigin = 'anonymous'; // Enable cross-origin image loading

    await new Promise((resolve) => {
      logoImage.onload = resolve;
    });

    const canvas = document.createElement('canvas');
    const ctx = canvas.getContext('2d');
    canvas.width = 100; // Set the desired width for your logo
    canvas.height = 50; // Set the desired height for your logo

    ctx.drawImage(logoImage, 0, 0, canvas.width, canvas.height);

    const logoDataUri = canvas.toDataURL('image/png');
    const logoImageId = workbook.addImage({
      base64: logoDataUri,
      extension: 'png',
    });

    worksheet.addImage(logoImageId, {
      tl: { col: 0, row: 0 },
      ext: { width: 100, height: 50 },
    });

    // Add the header row
    worksheet.addRow(['ID', 'Name', 'Address', 'City', 'Country']);

    // Add the student data
    data.forEach((student) => {
      worksheet.addRow([student.id, student.name, student.address, student.city, student.country]);
    });

    // Generate the Excel file
    const buffer = await workbook.xlsx.writeBuffer();

    // Create a blob and download link
    const blob = new Blob([buffer], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });
    const url = window.URL.createObjectURL(blob);

    // Create an anchor element for the download link
    const a = document.createElement('a');
    a.style.display = 'none';
    a.href = url;
    a.download = 'student-data.xlsx';

    // Trigger a click event on the anchor element to initiate the download
    document.body.appendChild(a);
    a.click();
    window.URL.revokeObjectURL(url);
  };

  return (
    <Button variant="success" onClick={exportToExcel}>
      Download Excel
    </Button>
  );
};

export default ExcelDownloadButton;
